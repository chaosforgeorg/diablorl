register_level "skeleton_lair"
{
	name    = "Skeleton King's Lair",
	depth   = 3,
	special = "level3",
	music   = 'music/dlvla.wav',
	map     = [[
################################################
############.......#############################
############.S.C.S.#############################
############.......#############################
############.a...a.#############################
############.......#############################
############.......#############################
############.......#############################
##############c.c###############################
######A.....!#ccs#######...!..A#################
######.c.s...#sss#######...s.c.#################
######..t....##+########....t..#################
######.s.....................s.#################
######.........................#################
######.........................#################
######.........................#################
#########...b#.........#b...##########.S.......#
#########...................##########.a..A....#
#########...................##########::::::...#
#########.........L.........#........#.........#
#########......ckkkkkc......#.s.c....#.........#
#########.......kkkkk.......Y..................#
#########......ckkkkkc......#.s.c....#.........#
#########...................#........#.........#
#########...................##########::::::...#
#########...................##########.a..a....#
#########...a#.........#a...##########.S.......#
######........................3#################
######.........................#################
######.........................#################
######.s.....................s.#################
######..t...!###.#.#.###....t..#################
######.c.s...###..s..###...s.c.#################
######a......###s...s###......a#################
################.....###########################
################.....###########################
################a...a##########.....############
################.....##########..C..############
################X#X#X##########.c...############
#############.a.......a.#######.c...############
#############...........#######.....############
#############.s...c...s.########Z###############
#...........#...........#..c........############
#.........ss#...........#...........############
#..t1.....ss+...........+.......2ta.############
#.........ss#...........#...........############
#...........#...........#..c........############
#############...........########################
#############.s...c...s.########################
#############...........########################
################.#.#.###########################
################.s.s.###########################
################.....###########################
################.....###########################
################.#.#.###########################
##############.........#########################
##############.........#########################
##############.........#########################
##############.........<########################
##############.........#########################
##############.........#########################
##############.........#########################
##############.........#########################
################################################
]],
	map_key = {
		['.'] = {"floor"},
		['#'] = {"stone_wall"},
		[':'] = {"grate"},
		['<'] = {"stairs_up"},
		['S'] = {"small_chest_magic"},
		['C'] = {"medium_chest_magic"},
		['t'] = {"open_sarcophagus"},
		['!'] = {"crucified_skeleton"},
		['+'] = {"closed_door_2"},
		['k'] = {"kings_sarcophagus"},
		['s'] = {"floor", "burning_dead"},
		['c'] = {"floor", "burning_dead_captain"},
		['a'] = {"floor", "corpse_bow"},
		['b'] = {"floor", "burning_dead_archer"},
		['A'] = {"floor", "horror_archer"},
		['L'] = {"floor", "leoric"},
		['1'] = {"lever1"},
		['2'] = {"lever2"},
		['3'] = {"lever3"},
		['X'] = {"moving_grate_1"},
		['Z'] = {"moving_wall_2"},
		['Y'] = {"moving_wall_3"},
	},

	OnCreate = function( self )
		generator.tile_place_raw( self, self.__proto.map, self.__proto.map_key )
	end,

	OnEnter = function(self)
		if (player.quest["leoric_quest"] == 1) then
			ui.msg("Leoric says \"The warmth of life has entered my tomb. Prepare yourself, mortal,")
			ui.msg("to serve my Master for eternity!\"")
			ui.play_sound("sfx/monsters/sking01.wav")
		end
	end
}
